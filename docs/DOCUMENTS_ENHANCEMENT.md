# 文件管理增強功能

## 🎯 功能概述

文件管理系統已經升級，提供更強大的分類、搜索和權限管理功能。

## ✨ 新功能

### 1. 文件分類系統
- **合約文件** (contracts) - 藍色標籤
- **表單文件** (forms) - 綠色標籤  
- **技術手冊** (manuals) - 紫色標籤
- **政策文件** (policies) - 橙色標籤
- **範本文件** (templates) - 粉色標籤
- **報告文件** (reports) - 灰色標籤

### 2. 智能搜索
- 搜尋文件標題
- 搜尋 URL 內容
- 搜尋標籤
- 即時過濾結果

### 3. 高級過濾
- 按分類過濾
- 按標籤過濾
- 組合過濾條件

### 4. 權限管理
- **所有人** (all) - 所有用戶可見
- **管理員** (admin) - 僅管理員可見
- **技師** (tech) - 僅技師可見
- **客服** (support) - 僅客服可見

### 5. 標籤系統
- 預設常用標籤
- 自定義標籤
- 快速添加/移除

### 6. 文件描述
- 詳細描述文件用途
- 幫助快速理解文件內容

## 📋 預設文件

系統包含以下示例文件：

| 文件名 | 分類 | 標籤 | 權限 | 描述 |
|--------|------|------|------|------|
| 驗收單範本 | 表單文件 | 驗收單, 範本 | 所有人 | 標準驗收單範本 |
| 技術手冊 - 冷氣清洗 | 技術手冊 | 技術手冊, 冷氣, SOP | 技師 | 冷氣清洗標準作業程序 |
| 員工手冊 | 政策文件 | 員工手冊, 政策 | 所有人 | 公司員工手冊及相關政策 |
| 報價單範本 | 範本文件 | 報價單, 範本 | 客服 | 標準報價單範本 |
| 安全規範 | 政策文件 | 安全規範, SOP | 所有人 | 工作安全規範及注意事項 |
| 品質標準 | 政策文件 | 品質標準, SOP | 技師 | 服務品質標準及檢查項目 |

## 🚀 使用方法

### 添加新文件
1. 點擊「新增文件」按鈕
2. 填寫基本信息：
   - 標題（必填）
   - URL（必填）
   - 分類（可選）
   - 描述（可選）
   - 訪問權限（可選）
3. 添加標籤：
   - 點擊預設標籤快速添加
   - 或輸入自定義標籤
4. 點擊「儲存」

### 搜索文件
1. 在搜索框輸入關鍵字
2. 系統會自動過濾結果
3. 支持標題、URL、標籤搜索

### 高級過濾
1. 點擊「顯示高級過濾」
2. 選擇分類
3. 選擇標籤
4. 查看過濾結果

### 編輯文件
1. 點擊文件卡片上的「編輯」按鈕
2. 修改相關信息
3. 點擊「儲存」

### 開啟文件
1. 點擊文件卡片上的「開啟」按鈕
2. 文件會在新標籤頁中開啟

## 🔧 技術實現

### 數據庫結構
```sql
-- 新增欄位
ALTER TABLE documents ADD COLUMN category text DEFAULT 'forms';
ALTER TABLE documents ADD COLUMN description text;
ALTER TABLE documents ADD COLUMN access_level text DEFAULT 'all';

-- 索引優化
CREATE INDEX idx_documents_category ON documents(category);
CREATE INDEX idx_documents_access_level ON documents(access_level);
CREATE INDEX idx_documents_tags ON documents USING gin(tags);
```

### 前端組件
- 搜索和過濾邏輯
- 標籤管理系統
- 權限控制
- 響應式設計

## 📱 響應式設計

- 桌面端：完整功能展示
- 平板端：適配中等螢幕
- 手機端：簡化界面，重點功能

## 🔒 安全考慮

- 權限驗證
- 輸入驗證
- XSS 防護
- 數據備份

## 🚀 部署說明

### 本地開發
```bash
npm run dev
```

### 生產環境更新
```bash
# 生成安全更新 SQL
npm run safe-update:enhance-documents

# 在 Supabase Dashboard 執行生成的 SQL
# 或使用命令行
npx supabase db push --include-all
```

## 📊 性能優化

- 數據庫索引優化
- 前端虛擬滾動（大量文件時）
- 圖片懶加載
- 緩存策略

## 🔮 未來規劃

- [ ] 文件版本控制
- [ ] 批量操作
- [ ] 文件預覽
- [ ] 使用統計
- [ ] 自動備份
- [ ] 移動端 APP

## 📞 支援

如有問題，請聯繫開發團隊或查看相關文檔。
